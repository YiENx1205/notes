项目名称：名医汇预约挂号平台

**开发环境**：IDEA+JDK1.8+ MySQL5.7

**技术选型**：Sping+SpringBoot+SpringCloud+mysql+MybatisPlus+Redis+MongoDB +RabbitMQ+Vue+elementUI

**项目描述**：名医汇预约挂号平台是近年来开展的一项便民就医服务，旨在缓解看病难、挂号难的就医难题，让患者能够随时随地轻松挂号！采用SpringCloud微服务架构和前后端分离技术，后台管理系统分为医院设置，数据字典，用户管理，订单管理，统计管理5个模块，前台用户系统分为：医院详情，用户登录，就诊人管理，预约挂号，就医提醒模块。

**责任描述**：

1. 参与后台需求分析，功能实现的讨论； 
2. 医院设置模块，医院设置与医院列表的增删改查。 
3. 数据字典模块，对数据字典树形显示，excel导入，导出接口开发。 
4. 前台用户登录功能，手机验证码，微信扫描登录接口开发。 
5. 前台用户实名认证与就诊人管理的增删改查。 
6. 订单管理模块订单列表，详情的查看。 

**技术描述**：

1. 基于MyBatisPlus实现数据的增删改查； 
2. 通过redis配置类与Cacheable注解实现数据字典中数据的缓存,提高查询效率; 
3. 通过EasyExcel实现数据字典的导入导出； 
4. 基于SpringCloud中Feign组件实现远程调用，gateway配置网关； 
5. 基于MongDB实现在医院基本信息，科室信息，排班信息的存储，结合Springboot对数据进行查看功能的编码; 
6. 主要第三方API：阿里云短信，微信授权，阿里云OSS云存储; 
7. 使用swagger2进行接口测试。



---



# 模块架构初步

hospital-manage：医院接口模拟端（已开发，直接使用）

yygh-parent：根目录，管理子模块：

- common：公共模块父节点
	- common-util：工具类模块，所有模块都可以依赖于它
	- rabbit-util：rabbitmq业务封装
	- service-util：service服务的工具包，包含service服务的公共配置类，所有               service模块依赖于它

- server-gateway：服务网关

- model：实体类模块

- service：api接口服务父节点
	- service-hosp：医院api接口服务
	- service-cmn：公共api接口服务
	- service-user：用户api接口服务
	- service-order：订单api接口服务
	- service-oss：文件api接口服务
	- service-sms：短信 api接口服务
	- service-task：定时任务服务
	- service-statistics：统计api接口服务
	- service-client：feign服务调用父节点
	- service-cmn-client：公共api接口
	- service-hosp-client：医院api接口
	- service-order-client：订单api接口
	- service-user：用户api接口

# Swagger2

编写和维护接口文档是每个程序员的职责，根据Swagger2可以快速帮助我们编写最新的API接口文档，再也不用担心开会前仍忙于整理各种资料了，间接提升了团队开发的沟通效率。

常用注解

swagger通过注解表明该接口会生成文档，包括接口名、请求方法、参数、返回信息的等等。

@Api：修饰整个类，描述Controller的作用

@ApiOperation：描述一个类的一个方法，或者说一个接口

@ApiParam：单个参数描述

@ApiModel：用对象来接收参数

@ApiModelProperty：用对象接收参数时，描述对象的一个字段

@ApiImplicitParam：一个请求参数

@ApiImplicitParams：多个请求参数



配置在service_util中

下列地址就是api操作地址

`http://localhost:8201/swagger-ui.html`

# 统一返回定义

在common_uitl中定义Result和ResultCodeEnum

com.yienx.yygh.common.result



# 条件查询vo

vo类封装条件值

然后编写controller

```
@RequestBody(required = false) HospitalSetQueryVo hospitalSetQueryVo
```

将表单值传到对应的对象中，false表示可以为空



# 全局异常处理

spring boot 默认情况下会映射到 /error 进行异常处理，但是提示并不十分友好，下面自定义异常处理，提供友好展示。

common-util里创建GlobalExceptionHandler

## 自定义异常

```java
try {
    int a = 1/0;
} catch (Exception e) {
    throw new YyghException("除数不能为0", 201);
}
// 
@ExceptionHandler(YyghException.class)
@ResponseBody
public Result error(YyghException e) {
    e.printStackTrace();
    // return Result.fail();
    return Result.build(e.getCode(), e.getMessage());
}
// ResponseBody
{
  "code": 201,
  "message": "除数不能为0",
  "data": null,
  "ok": false
}
```



# 日志

日志记录器（Logger）的行为是分等级的。如下表所示：

分为：OFF、FATAL、ERROR、WARN、INFO、DEBUG、ALL

从左往右显示的越全

默认情况下，spring boot从控制台打印出来的日志级别只有INFO及以上级别，可以配置日志级别

```properties
# 设置日志级别
logging.level.root=WARN
```



这种方式只能将日志打印在控制台上

## 配置日志

resources/logback-spring.xml

